(window._vfP=window._vfP||[]).push([[121],{435:function(t,n,e){"use strict";e.r(n);e(41),e(12),e(6),e(7),e(4),e(18),e(36),e(37);var u,r=e(0),i=e(285);function o(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);n&&(u=u.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,u)}return e}function c(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?o(Object(e),!0).forEach((function(n){_(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function _(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var a,d=(_(u={},r.Pc,(function(t,n,e,u){return function(e){var i=t[e];if(i){var o=u[r.Kb];return c({},i,{thread_palette:n[r.Rc](e),visible_content:i.visible_content.filter(o),realtime_content:i.realtime_content.filter(o)})}}})),_(u,r.Vc,(function(t,n,e,u){return function(t){var e=n[r.Pc](t);if(e){var i=u[r.Z],o=u[r.ab];return c({},e,{pinned_content:e.visible_content.filter(i),unpinned_content:e.visible_content.filter(o)})}}})),_(u,r.pd,(function(t,n,e,u){return function(n){return t[n].visible_content.filter(u[r.Kb])}})),_(u,r.Qc,(function(t){return function(n){var e=t[n],u=e.total_content,r=e.visible_content,i=e.realtime_content;return u-r.length-i.length}})),_(u,r.nd,(function(t,n,e,u){return function(n){return t[n].visible_replies.map(u[r.P])}})),_(u,r.Sc,(function(t){return function(n){return t[n].realtime_content.length}})),_(u,r.vc,(function(t){return function(n){return t[n].selected_content}})),_(u,r.Vb,(function(t){return function(n){var e=n.content_uuid,u=n.thread_uuid;return t[u].unread_reply_content.includes(e)}})),_(u,r.Ub,(function(t){return function(n){var e=n.content_uuid,u=n.thread_uuid;return t[u].unread_mention_content.includes(e)}})),_(u,r.zb,(function(t){return function(n){return Boolean(t[n].unread_reply_content.length)}})),_(u,r.xb,(function(t){return function(n){return Boolean(t[n].unread_mention_content.length)}})),_(u,r.yb,(function(t,n,e,u){return function(n){var e=n.thread_uuid,i=n.subthread_uuid;return Boolean(t[e].unread_reply_content.filter((function(t){return u[r.P](t).parent_uuid===i})).length)}})),_(u,r.wb,(function(t,n,e,u){return function(n){var e=n.thread_uuid,i=n.subthread_uuid;return Boolean(t[e].unread_mention_content.filter((function(t){return u[r.P](t).parent_uuid===i||u[r.ad](t).target_uuid===i})).length)}})),_(u,r.bd,(function(t,n,e,u){return function(n){return t[n].unread_reply_content.map(u[r.P])}})),_(u,r.Ab,(function(t,n,e,u){return function(n){return t[n].unread_reply_content.filter(u[r.U]).length>0}})),_(u,r.Rc,(function(t){return function(n){var e=t[n],u=e.unread_mention_content,r=e.unread_reply_content;return u.length>0?i.a.MENTION:r.length>0?i.a.ACCENT:i.a.LIGHT_PRIMARY}})),_(u,r.Eb,(function(t){return function(n){return t[n].initial_promo_uuid}})),_(u,r.j,(function(t,n,e,u){return function(e){if(!t[e].initial_promo_uuid)return[];var i=n[r.pd](e),o=u[r.td](e).promo_interval,c=i.indexOf(t[e].initial_promo_uuid);return i.filter((function(n,u){return u!==i.length-1&&(n===t[e].initial_promo_uuid||(u>c&&(u-c)%o==0||u<c&&(c-u)%o==0))}))}})),_(u,r.Tb,(function(t,n){return function(t,e){return n[r.j](t).includes(e)}})),u),l=(e(139),e(1)),f=e(59),s=e(21);function v(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var h,p=Object(f.b)(s.default,"thread_uuid",(function(t){return{thread_uuid:t,thread_top_uuid:null,visible_content:[],unread_mention_content:[],unread_reply_content:[],realtime_content:[],selected_content:[],initial_promo_uuid:null,total_content:0,is_in_view:!1,page_from:null,more_available:!1}})),b=(v(a={},l.T,p),v(a,l.Vb,(function(t,n){s.default.delete(t,n)})),v(a,l.Ib,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].visible_content=t[e].visible_content.filter((function(t){return t!==u}))})),v(a,l.Hb,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].realtime_content=t[e].realtime_content.filter((function(t){return t!==u}))})),v(a,l.D,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].visible_content.includes(u)||t[e].visible_content.push(u)})),v(a,l.xb,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;if(!t[e].visible_content.includes(u)){var r=t[e].visible_content;t[e].visible_content=[u].concat(r)}})),v(a,l.C,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].realtime_content.includes(u)||t[e].realtime_content.push(u)})),v(a,l.wb,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;if(!t[e].realtime_content.includes(u)){var r=t[e].realtime_content;t[e].realtime_content=[u].concat(r)}})),v(a,l.E,(function(t,n){var e=n.thread_uuid,u=n.limit,r=t[e],i=r.visible_content,o=r.realtime_content,c=o.slice(0,u);t[e].realtime_content=o.slice(u),t[e].visible_content=i.concat(c)})),v(a,l.yb,(function(t,n){var e=n.thread_uuid,u=n.limit,r=t[e],i=r.visible_content,o=r.realtime_content,c=o.slice(o.length-u,o.length);t[e].realtime_content=o.slice(0,o.length-u),t[e].visible_content=c.concat(i)})),v(a,l.ad,(function(t,n){var e=n.thread_uuid,u=n.is_in_view;t[e].is_in_view=u})),v(a,l.P,(function(t,n){t[n]&&(t[n].visible_content=[],t[n].page_from=null,t[n].more_available=!1)})),v(a,l.F,(function(t,n){var e=n.thread_uuid,u=n.contents,r=n.new_page,i=void 0===r||r,o=u.map((function(t){return t.content_uuid})).filter((function(n){return!t[e].visible_content.includes(n)}));t[e].visible_content=t[e].visible_content.concat(o),t[e].realtime_content=t[e].realtime_content.filter((function(t){return!o.includes(t)})),i&&o.length&&(t[e].page_from=o[o.length-1])})),v(a,l.zb,(function(t,n){var e=n.thread_uuid,u=n.contents.sort((function(t,n){return t.time-n.time})).map((function(t){return t.content_uuid})).filter((function(n){return!t[e].visible_content.includes(n)})),r=t[e].visible_content;t[e].visible_content=u.concat(r),t[e].realtime_content=t[e].realtime_content.filter((function(t){return!u.includes(t)})),t[e].page_from=u[0]})),v(a,l.e,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].unread_mention_content.push(u)})),v(a,l.f,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].unread_reply_content.push(u)})),v(a,l.Lb,(function(t,n){var e=n.thread_uuid,u=n.content_uuid,r=t[e].unread_mention_content.indexOf(u);t[e].unread_mention_content.splice(r,1)})),v(a,l.Mb,(function(t,n){var e=n.thread_uuid,u=n.content_uuid,r=t[e].unread_reply_content.indexOf(u);t[e].unread_reply_content.splice(r,1)})),v(a,l.lb,(function(t,n){t[n].total_content+=1})),v(a,l.zc,(function(t,n){var e=n.thread_uuid,u=n.content_uuids;t[e].selected_content=t[e].selected_content.concat(u)})),v(a,l.N,(function(t,n){t[n].selected_content=t[n].selected_content.splice()})),v(a,l.Hc,(function(t,n){var e=n.thread_uuid,u=n.content_uuid;t[e].initial_promo_uuid=u})),v(a,l.Ic,(function(t,n){var e=n.thread_uuid,u=n.more_available;t[e].more_available=u})),a),m=(e(10),e(3)),g=e(123);function P(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var y=(P(h={},m.v,(function(t,n){var e=t.getters,u=t.commit,i=t.rootGetters,o=n.content_container_uuid,c=n.contents,_=n.more_available,a=c.filter((function(t){return t.thread_uuid===o}));if(a.forEach((function(t){var n=t.content_uuid,e=t.total_replies,o=c.filter((function(t){return t.thread_uuid===n})).sort((function(t,n){return t.time-n.time})).map((function(t){return t.content_uuid})),_=i[r.Zc](n).map((function(t){return t.content_uuid})),a={thread_uuid:n,thread_top_uuid:t.thread_uuid,visible_content:o,total_content:e,unread_mention_content:_};o.length>0&&(a.page_from=o[0]),u(l.T,a)})),!e[r.Pc](o)){var d=a.map((function(t){return t.content_uuid})),f=i[r.td](o).first_promo_position,s=d.length>f?d[f-1]:null;u(l.T,{thread_uuid:o,visible_content:d,initial_promo_uuid:s,page_from:d[d.length-1],more_available:_})}})),P(h,m.Tb,(function(t,n){var e=n.content_container_uuid,u=n.thread_uuid,i=n.selected_content_uuids,o=n.fetchAction,c=t.getters,_=t.commit,a=t.dispatch,d=t.rootGetters,f=c[r.Pc](u);return function(t,n,e,u,i){if(n)return Promise.resolve();var o=t.getters,c=t.commit,_=t.dispatch,a=t.rootGetters;return _(i,{content_container_uuid:e,content_uuids:u},{root:!0}).then((function(_){var d=a[r.P](_[0]),f=[];return d.thread_uuid===e&&(f=a[r.Zc](u).map((function(t){return t.content_uuid}))),c(l.T,{thread_uuid:u,thread_top_uuid:d.thread_uuid,total_content:d.total_replies,unread_mention_content:f}),n=o[r.Pc](u),function(t,n,e,u){var i=t.getters,o=t.commit,c=t.dispatch,_=t.rootGetters,a=n===e.thread_top_uuid?e.thread_uuid:e.thread_top_uuid,d=_[r.P](a);if(d){if(!i[r.Pc](a)){var f=_[r.Zc](a).map((function(t){return t.content_uuid})),s={thread_uuid:a,thread_top_uuid:n,total_content:d.total_replies,unread_mention_content:f};o(l.T,s)}return o(l.F,{thread_uuid:n,contents:[d],new_page:!1}),Promise.resolve()}return c(u,{content_container_uuid:n,content_uuids:a},{root:!0}).then((function(t){var e=_[r.P](t[0]),u=_[r.Zc](a).map((function(t){return t.content_uuid})),i={thread_uuid:a,thread_top_uuid:n,total_content:e.total_replies,unread_mention_content:u};o(l.T,i),o(l.F,{thread_uuid:n,contents:[e],new_page:!1})}))}(t,e,n,i)}))}(t,f,e,u,o).then((function(){if(f||(f=c[r.Pc](u)),i){_(l.N,u);var t=i.filter((function(t){return!d[r.P](t)})).join();if(t.length>0)return a(o,{content_container_uuid:e,content_uuids:t},{root:!0}).then((function(){_(l.zc,{thread_uuid:u,content_uuids:i})}));_(l.zc,{thread_uuid:u,content_uuids:i})}return Promise.resolve()}))})),P(h,m.c,(function(t,n){var e=t.commit,u=t.getters,i=t.dispatch,o=t.rootGetters,c=n.content_container_uuid,_=n.parent_uuid,a=n.actor_uuid,d=n.parent_actor_uuid,f=n.thread_uuid,s=n.content_uuid,v=u[r.Pc](f);if(!v)return Promise.resolve();var h=f===c,p=o[r.a](c),b=p.thread_uuid===f||p.parent_thread_uuid===f,P=o[r.td](c).promo_interval;if(!o[r.Kb](s))return Promise.resolve();var y=v.realtime_content,O=v.visible_content,w=v.is_in_view,j=y.includes(s)||O.includes(s);if((h||b)&&j)return Promise.resolve();var T=function(t,n,e,u,i,o){var c=t[r.U](e),_=0===u.length&&i;if(n)return!g.d||_||o?l.xb:l.wb;if(c||_)return l.D;return l.C}(o,h,s,y,w,0===O.length);if(e(T,{thread_uuid:f,content_uuid:s}),T===l.xb&&!u[r.Eb](f)){var E=u[r.pd](f);E.length>P&&e(l.Hc,{thread_uuid:f,content_uuid:E[E.length-P-1]})}return b&&p.parent_thread_uuid!==c&&e(T,{thread_uuid:p.thread_uuid,content_uuid:s}),e(l.lb,f),i(m.d,{parent_actor_uuid:d,parent_uuid:_,actor_uuid:a,content_container_uuid:c,thread_uuid:f,content_uuid:s})})),P(h,m.d,(function(t,n){var e=t.rootGetters,u=t.commit,i=n.parent_actor_uuid,o=n.parent_uuid,c=n.actor_uuid,_=n.content_container_uuid,a=n.thread_uuid,d=n.content_uuid,f=e[r.fb];u(f===c||o===_||!(f===i)?l.f:l.e,{thread_uuid:a,content_uuid:d})})),P(h,m.zc,(function(t,n){var e=t.getters,u=t.commit,i=t.rootGetters,o=n.thread_uuid,c=n.content_uuid,_=i[r.S](c),a=e[r.Pc](o),d=!a.thread_top_uuid,f=_===a.thread_top_uuid,s={thread_uuid:d||f?o:a.thread_top_uuid,content_uuid:c},v=e[r.Ub](s),h=e[r.Vb](s);v&&u(l.Lb,s),h&&u(l.Mb,s)})),P(h,m.Ad,(function(t,n){var e=t.getters,u=t.commit,i=n.thread_uuid,o=n.content_uuid,c=n.current_index;if(e[r.Eb](i)===o){var _=e[r.pd](i);_[c]!==o&&u(l.Hc,{thread_uuid:i,content_uuid:_[c]})}})),h);e.d(n,"storeModule",(function(){return O}));var O=function(){return{namespaced:!0,state:function(){return{}},getters:d,actions:y,mutations:b}}}}]);